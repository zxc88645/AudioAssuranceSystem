<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>錄音檔檢核平台</title>
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div class="app-shell">
      <header class="header">
        <div class="header-content">
          <div class="header-badge">System 2</div>
          <h1>錄音檔檢核平台</h1>
          <p>即時監控系統、錄音檔品質檢核，集中呈現比對與檢核結果。</p>
          <div class="header-meta">
            <span class="header-chip">自動檢核流程</span>
            <span class="header-chip">音訊差異對比</span>
            <span class="header-chip">AI 分析摘要</span>
          </div>
        </div>
      </header>

      <main id="main-content" class="main-content">
        <nav class="tabs" aria-label="檢視切換">
          <button class="tab-btn active" type="button" data-tab="realtime-monitoring">
            <span class="tab-label">即時監控</span>
            <span class="tab-caption">追蹤目前通話流程</span>
          </button>
          <button class="tab-btn" type="button" data-tab="historical-reports">
            <span class="tab-label">歷史報告</span>
            <span class="tab-caption">快速回顧先前結果</span>
          </button>
        </nav>

        <section id="realtime-monitoring" class="tab-content active" aria-label="即時監控">
          <div class="section-header">
            <div>
              <h2>即時監控</h2>
              <p>掌握從等待通話到檢核完成的每個流程節點。</p>
            </div>
          </div>

          <div class="monitoring-grid">
            <div class="card card-progress">
              <div id="call-progress" class="call-progress">
                <div class="card-heading call-progress-heading">
                  <div>
                    <h3>流程進度</h3>
                    <p>狀態將依照系統回傳自動更新。</p>
                  </div>
                  <div class="progress-controls">
                    <button id="reset-progress-btn" class="btn btn-ghost btn-sm" type="button">重置</button>
                    <span class="status-chip status-chip-neutral progress-status" id="progress-status-text">等待通話</span>
                  </div>
                </div>
                <canvas id="progress-canvas" class="progress-canvas" width="800" height="300"></canvas>
                <div class="progress-bar" role="progressbar" aria-live="polite">
                  <div class="progress-bar-fill" id="progress-bar-fill"></div>
                </div>
                <p class="progress-extra-message" id="progress-extra-message"></p>
              </div>
            </div>

            <div class="card card-live-log" style="display: none;">
              <div class="card-heading">
                <div>
                  <h3>即時事件紀錄</h3>
                  <p>最新的檢核訊息會於此處自動滾動顯示。</p>
                </div>
              </div>
              <div id="realtime-log" class="transcript-content live-log" aria-live="polite">
                <p><i>目前等待通話開始...</i></p>
              </div>
            </div>
          </div>
        </section>

        <section id="historical-reports" class="tab-content" style="display: none" aria-label="歷史報告">
          <div class="section-header">
            <div>
              <h2>歷史報告</h2>
              <p>統整所有完成的檢核結果，可回放音訊與檢視 AI 分析。</p>
            </div>
            <div class="section-actions">
              <button id="cleanup-reports-btn" class="btn btn-ghost btn-sm" type="button">清理舊報告</button>
              <button id="refresh-reports-btn" class="btn btn-secondary" type="button">重新整理</button>
              <span class="section-hint">自動每 30 秒更新</span>
            </div>
          </div>

          <div id="list-view" class="card">
            <div class="table-container">
              <table id="reports-table" aria-describedby="reports-table">
                <thead>
                  <tr>
                    <th scope="col">報告 ID</th>
                    <th scope="col">通話 Session ID</th>
                    <th scope="col">檢核狀態</th>
                    <th scope="col">準確度</th>
                    <th scope="col">完成時間</th>
                    <th scope="col">操作</th>
                  </tr>
                </thead>
                <tbody id="reports-tbody"></tbody>
              </table>
              <div id="no-reports-message" class="empty-state hidden">
                <div class="empty-state-illustration"></div>
                <p>目前尚無歷史報告，稍後再試或手動刷新。</p>
              </div>
            </div>
          </div>
        </section>

        <section id="detail-view" class="detail-view hidden" aria-label="報告詳情">
          <div class="detail-toolbar">
            <button id="back-to-list-btn" class="btn btn-ghost" type="button">← 返回列表</button>
            <span class="detail-breadcrumb">歷史報告 · 詳細檢視</span>
          </div>

          <div class="detail-grid">
            <div class="card report-header">
              <div class="card-heading">
                <div>
                  <h3>報告摘要</h3>
                  <p>快速瀏覽此次檢核的基本資訊。</p>
                </div>
              </div>
              <div class="report-meta">
                <div class="meta-item">
                  <span class="meta-label">報告 ID</span>
                  <span class="meta-value" id="detail-report-id"></span>
                </div>
                <div class="meta-item">
                  <span class="meta-label">通話 Session ID</span>
                  <span class="meta-value" id="detail-session-id"></span>
                </div>
              </div>
            </div>

            <div class="card llm-card">
              <div class="card-heading">
                <div>
                  <h3>LLM 分析結果</h3>
                  <p>AI 對音訊差異與品質的重點結論。</p>
                </div>
              </div>
              <div class="llm-summary">
                <span id="detail-accuracy-score" class="score-badge score-medium">--</span>
                <p id="detail-summary"></p>
              </div>
              <div class="llm-details">
                <p><strong>評估原因：</strong><span id="detail-reasoning"></span></p>
                <div class="llm-lists">
                  <div>
                    <h4>關鍵差異</h4>
                    <ul id="detail-key-differences"></ul>
                  </div>
                  <div>
                    <h4>系統建議</h4>
                    <ul id="detail-suggestions"></ul>
                  </div>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card-heading">
                <div>
                  <h3>音訊播放與對比</h3>
                  <p>直接聆錄音檔的差異。</p>
                </div>
              </div>
              <div class="audio-comparison">
                <div class="audio-player-wrapper">
                  <h4>線上音檔轉錄</h4>
                  <audio id="recording-audio-player" controls></audio>
                </div>
                <div class="audio-player-wrapper">
                  <h4>錄音檔</h4>
                  <audio id="monitoring-audio-player" controls></audio>
                </div>
                <div class="audio-player-wrapper">
                  <h4>備份錄音檔</h4>
                  <audio id="backup-audio-player" controls></audio>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card-heading">
                <div>
                  <h3>語音轉文字對照</h3>
                  <p>比較兩套系統的 STT 結果，快速定位差異。</p>
                </div>
              </div>
              <div class="stt-comparison">
                <div class="transcript-panel">
                  <h4>線上音檔轉文字</h4>
                  <div id="recording-transcript" class="transcript-content"></div>
                </div>
                <div class="transcript-panel">
                  <h4>錄音檔轉文字</h4>
                  <div id="monitoring-transcript" class="transcript-content"></div>
                </div>
                <div class="transcript-panel">
                  <h4>備份錄音檔轉文字</h4>
                  <div id="backup-transcript" class="transcript-content"></div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>

    <script src="js/main.js"></script>
  </body>
</html>
